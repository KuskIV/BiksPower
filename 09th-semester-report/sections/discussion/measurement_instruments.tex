\section{Measuring instruments}

The first section of the discussion will cover the different measuring instruments used. This will be done by first discussing them independently, in terms of ease of use etc., before all measuring instruments will be compared.

\paragraph*{Open Hardware Monitor / Libre Hardware Monitor:} One issue with LHM is the sampling rate. It was found in \cref{sec:rw_key_takeaways} that using the same sampling rate for the measuring instruments is beneficial when attempting to compare them. However, during some initial testing with LHM, it was found that using a sampling rate of more than 2 Hz would frequently produce errors. Therefore a frequency of 2 Hz is used during the experiments with LHM, whereas the other measuring instruments use a frequency of 10 Hz. We decided to not limit the other measuring instruments to the maximum frequency of LHM and instead accept that it could be a disadvantage with LHM. Besides this and a lack of documentation, there were no other issues importing and using the library.

\paragraph*{Intel Power Gadget:} In terms of using measuring instruments, Intel Power Gadget is the most promising. This tool had official documentation and an API making it very user-friendly. The issues came when executing on the Surface Book, where it crashed for unknown reasons. The exact extent of why these crashes occur and what devices it occurs on is unknown but is something to explore in the future.

\paragraph*{E3:} This measuring instrument was based on the numbers provided by Microsoft, presented in \cref{subsec:e3}, very promising. However, when using the tool, some issues arose. This was first of all regarding the usecase. For the other measuring instruments, they could either be started and stopped as wished, or the energy consumption could be read in real-time. This was different for E3, where you could start it, but since it only performed a measurement once a minute, it was vital to know when E3 did this. The sampling was important to know about, to be sure the energy consumption read was for the whole duration of one minute. Since no official documentation was found this was a difficult task and meant we had to rely on blog posts and even when considering blog posts, the material about how E3 worked was limited.
The claims made by Microsoft regarding the MAXIM chip which was the reason why the Surface Book was used, are also 7 years old by the time of writing this and the chip do not seem to exist in any Surface devices since 2016, which could be speculated that they either do not work as great as Microsoft claimed or because they were too expensive to implement. For E3, the measurements were in most cases close to those made by IPG and LHM, which indicated it performed similarly compared to the other measuring instruments. Given that E3 could isolate the energy consumption of each process running on the DUT, it could have been interesting to see how well this isolation was. An experiment could have been conducted where E3 measurements on an idle DUT were compared to E3 measurements when the DUT did some background work. However, this was not prioritized and is therefore a subject for future work. For E3, it is noted in \cref{subsec:e3} how E3 claims to work best when it is not connected to a charger. It would be interesting to try and compare E3 measurements where E3 was and was connected to a charger, to see how this would affect the results. This is however also a subject for future work.


\paragraph*{Clamp:} When considering the results from the first experiment presented in \cref{ch:results}, the clamp was observed to have a high deviation compared to the other measuring instruments. The issue with the clamp compared to the other measuring instruments is how it measures the energy consumption of the entire system compared and not just the CPU. Because of this, many factors can impact the measurements. To minimize the variability the fan speed was set to maximum and the external GPU was removed. Furthermore, dynamic energy consumption was implemented to isolate the energy consumption from specifically running a test case by removing the energy consumption of the fans etc. As mentioned in \cref{subsec:Equipment}, the MN60 is an analog current sensor which is different from digital sensors, where this difference could account for the deviations seen in the results. Analog sensors output a continuous measurement, while digital sensors discrete output\todo{Lidt krinklet er ikke helt sikker på hvad der skal stå.} which does some processing of the data.\cite{DigimonsVSAnamons} Another thing that could help explain the deviations is the power supply of the workstation, there are at least two reasons why this could be the case. In the power supply, there are several capacitors that change how the computer uses energy as they could help flatten out any spikes in energy consumption, but this would mostly be a problem with smaller measurements and not the minute long once we conduct\cite{hackenberg2013}. The second and more likely reason, in our opinion, is the unknown efficiencies of the power supply. In \cref{subsec:expec_energy_consumption} we covered power supply efficiency, and that the only tested efficiency are $20$\%,$50$\% and $100$\% load, and that these efficiencies did not have a linear relationship. This means that at other loads the efficiency could fluctuate, and affect the measurements. 


\paragraph*{RAPL:} This measuring instrument was similar to LHM and IPG in terms of usability. It also had some documentation, which was useful. RAPL has the advantage of not being required to install anything, it just works when installing Linux. In other works\cite{RAPL_in_action}, one thing noted when using RAPL, is how the energy consumption register will overflow approximately ever $52$ minute, depending on the hardware. These overflows, resulting in a reset of the register were however not observed in our data, which could be because the DUT was restarted more frequently than an overflow. This was however not explored and is a problem for future work.

\paragraph*{Summary:} In our work, five different measuring instruments have been used and if the use case is to measure the energy consumption of software, most of them worked as expected. The only exception to this was E3, as it required the test case to run for one minute, but it was on the other hand the only measuring instrument able to separate the different processes running, rather than only presenting the energy consumption of the entire CPU. 