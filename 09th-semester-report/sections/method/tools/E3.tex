\subsection{Microsoft Energy Estimation Engine}
Microsoft Energy Estimation Engine (E3) is a tool created to monitor the energy consumption of batteries on windows devices. E3 monitors the computer at all times to create battery energy usage reports, accessible in the power battery settings under Battery usage.\cite[p.43]{E3WinHec}
The reported accuracy of E3 varies based on different factors specifically if a special energy measurement chip is built into the computer. The reported accuracies for each part of the computer can be seen in \cref{tab:E3_acc_Table}. 

\input{tabels/E3Accuracy.tex}

In \cref*{tab:E3_acc_Table} it can be observed that there is a large difference in the accuracy between devices with and without the chip on the motherboard. The chips referred to here are specifically the Maxim MAX34407 and the Maxim MAX34417, contained for example in different Microsoft Surface devices.

% , finding the models of computers that actually contain these chips have proven difficult, with very few computer known to actually contain the chip. 

E3 differs from other tools with similar functionality in that it creates estimates for each process running on the machine individually. Most tools will instead provide some energy usage estimate of the entire system in a given time span. This makes it easier to draw certain conclusions about energy usage from E3 if the estimations are accurate. 

The reports created by E3 will by default contain logs of power usage for the previous $7$ days, where each process and their power usage is logged. Each log entry accounts for $1-5$ minutes depending on the actual length of the process execution \cite[]{E3Video}. Each entry in the report contains many attributes, where some of the relevant attributes to this study can be seen in \cref{tab:E3_attr_Table}

\input{tabels/E3AttrTable.tex}

As of the time of writing no study or external entity apart from Microsoft themselves has neither used nor verified the accuracy and reliability of the numbers provided by E3. Because of this the information about E3 mostly comes from blog posts or presentations by Microsoft and is very sparse in the information provided. An additional limitation is how this software only works on windows devices with a battery, meaning that E3 is not accessible on the average Windows workstation.

To generate the raw energy report from E3 an elevated command shell is needed. Then the desired destination for the report should be navigated to, then in the command shell write as can be seen in \cref{listing:start_e3}

\begin{lstlisting}[caption=How to start E3, label=listing:start_e3]
    powercfg.exe \srumutil
\end{lstlisting}

Upon successful execution, the message in \cref{listing:success_e3} can be observed.

\begin{lstlisting}[caption=If the report is created successfully
    , label=listing:success_e3]
    Completed with status 0 (0x00000000): Examples of the full measurements and an example with only the attributes that are relevant to this study can be found in the appendix, like with the other measurement tools.
\end{lstlisting}


% start normal listing
% \begin{lstlisting}[language=Python, caption=Python example]

% From file
% \lstinputlisting[language=Octave]{BitXorMatrix.m}